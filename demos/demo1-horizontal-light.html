<!DOCTYPE html>
<html>
  <head>
    <title>DEMO: horizontal-light</title>

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
      }

      #anim {
        background-color: wheat;
      }
      #anim_ {
        width: 100%;
        height: 30px;
      }
      .range__slider {
        position: relative;
        width: 150px;
        height: calc(40px - 10px);
        display: flex;
        justify-content: center;
        align-items: center;
        background: rgb(255, 255, 255);
        border-radius: 8px;
      }
      .range__slider::before,
      .range__slider::after {
        position: absolute;
        color: rgb(2, 33, 99);
        font-size: 0.9rem;
        font-weight: bold;
      }
      .range__slider::before {
        content: attr(data-min);
        left: 10px;
      }
      .range__slider::after {
        content: attr(data-max);
        right: 10px;
      }
      .range__slider .length__title::after {
        content: attr(data-length);
        position: absolute;
        right: -1px;
        padding-top: -3px;

        font-variant-numeric: tabular-nums;
        color: rgb(9, 32, 110);
      }

      #slider {
        -webkit-appearance: none;
        width: calc(100% - (2px));
        height: 30px;
        border-radius: 5px;
        background: rgba(0, 0, 0, 0.314);
        outline: none;
        padding: 0;
        margin: 0;
        cursor: pointer;
      }
      #slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: blue;
        cursor: pointer;
        transition: all 0.15s ease-in-out;
      }
      #slider::-webkit-slider-thumb:hover {
        background: #8605ff;
        transform: scale(1.2);
      }
      #slider::-moz-range-thumb {
        width: 20px;
        height: 20px;
        border: 0;
        border-radius: 50%;
        background: blue;
        cursor: pointer;
        transition: background 0.15s ease-in-out;
      }
      #slider::-moz-range-thumb:hover {
        background: blue;
      }
      .right {
        float: right;
        position: relative;
      }
      .animate {
        -webkit-transition: all 0.3s ease-in-out;
        -moz-transition: all 0.3s ease-in-out;
        -ms-transition: all 0.3s ease-in-out;
        -o-transition: all 0.3s ease-in-out;
        transition: all 0.3s ease-in-out;
        -webkit-transform: translateY(-95%);
        -moz-transform: translateY(-95%);
        -ms-transform: translateY(-95%);
        -o-transform: translateY(-95%);
        transform: translateY(-95%);
      }
      .animate:hover {
        -webkit-transform: translateX(0%);
        -moz-transform: translateX(0%);
        -ms-transform: translateX(0%);
        -o-transform: translateX(0%);
        transform: translateX(0%);
      }
      #nav-body-views {
        width: 100%;
        height: 100%;
      }
    </style>
    <link
      rel="stylesheet"
      type="text/css"
      href="../themes/material-light.css"
    />
    <link rel="stylesheet" type="text/css" href="../themes/w.scss" />
    <script type="text/javascript" src="./jquery.js"></script>
  </head>

  <body>
    <div class="animate">
      <div id="bar"></div>

      <div id="nav-body-ctrls">
        <!-- address -->
        <p title="Заблокировать окно">
          <button onclick="mouse_ignore()">
            <img src="../img/lock.png" />
          </button>
        </p>
        <div class="right">
          <p title="Прозрачность окна">
            <input
              type="range"
              value="1"
              min="0.05"
              max="1"
              step="0.05"
              id="slider"
            />
          </p>
        </div>
      </div>

      <div id="nav-body-tabs">
        <!-- tabs -->
      </div>
    </div>

    <div id="nav-body-views">
      <!-- view -->
    </div>

    <script>
      var ignore = false;
      function mouse_ignore() {
        const { BrowserWindow } = require("electron").remote;
        var win = BrowserWindow.getFocusedWindow();
        if (ignore == true) {
          win.setIgnoreMouseEvents(false);
          ignore = false;
        } else {
          win.setIgnoreMouseEvents(true);
          ignore = true;
          ipcRenderer.send("noty", "Unlock: CTRL + E / and tray");
        }
      }
      $(window).load(function() {});
      $("#bar").hover(
        function() {
          $(".anim").slideDown("slow");
        },
        function() {}
      );
      $(".anim").hover(
        function() {
          $(this).slideDown("slow");
        },
        function() {
          $(".anim").slideUp("slow");
        }
      );
      $(".anim_").hover(
        function() {
          $(".anim").slideDown("slow");
        },
        function() {}
      );
    </script>
    <script>
      function zoomIn() {}
      function zoomOut() {}
    </script>
    <script>
      var bar = document.getElementById("bar");
      const electronTitlebarWindows = require("electron-titlebar-windows");
      const { remote } = require("electron");
      const { ipcRenderer } = require("electron");
      var zoom = 0;
      // ipc
      function zoomIn() {
        const webview = document.querySelector("webview");
        let actualZoom = zoom;
        if (actualZoom == null) {
          actualZoom = 1;
        }
        webview.setZoomFactor(actualZoom + 1);
        zoom = actualZoom + 1;
      }

      function zoomOut() {
        const webview = document.querySelector("webview");
        let actualZoom = zoom;
        if (actualZoom == null) {
          actualZoom = 1;
        }
        webview.setZoomFactor(actualZoom - 1);
        zoom = actualZoom - 1;
      }
      //disable_skip
      ipcRenderer.on("disable_skip", (event, arg) => {
        const { BrowserWindow } = require("electron").remote;
        var win = BrowserWindow.getFocusedWindow();
        if ((arg = "false")) {
          console.log("b false");
          win.setIgnoreMouseEvents(false);
          ignore = false;
        } else {
          console.log("a");
          win.setIgnoreMouseEvents(true);
          ignore = true;
        }
      });
      ipcRenderer.on("disable_skip_tray", (event, arg) => {
        ignore = false;
      });
      ipcRenderer.on("web_view_range", (event, arg) => {
        const webview = document.querySelector("webview");
        const { webFrame } = require("electron");

        console.log(arg); // prints "pong"
        if (arg == "plus") {
          //  webFrame.setZoomFactor(a++);
          zoomIn();
          // var a = webFrame.getZoomLevel();
        } else {
          // webFrame.setZoomFactor(a--);
          zoomOut();
        }
      });
      ipcRenderer.on("drag", (event, arg) => {
        const { BrowserWindow } = require("electron").remote;
        var win = BrowserWindow.getFocusedWindow();
        const webview = document.querySelector("webview");
        var area = document.getElementById("nav-body-views");
        //  win.focus();
        //   var area = document.body;
        if (arg == "true") {
          area.setAttribute("style", "-webkit-app-region: drag;");
          //  win.reload();

          webview.reload();
        } else {
          area.setAttribute("style", "-webkit-app-region: no-drag;");
          //  win.reload();

          webview.reload();
        }
      });
      //

      /** Options */

      let titlebar = new electronTitlebarWindows({
        darkMode: false,
        color: "rgb(220, 200, 200)",
        backgroundColor: "rgb(24,22,23)",
        draggable: true,
        fullscreen: false
      });
      /**
       * DOM
       */
      titlebar.appendTo(bar);
      /** Event#close */
      titlebar.on("close", () => {
        console.info("close");
        remote.getCurrentWindow().close();
      });
      /** Event#fullscreen */
      titlebar.on("fullscreen", () => {
        console.info("fullscreen");
        remote.getCurrentWindow().setFullScreen(true);
      });
      /** Event#minimize */
      titlebar.on("minimize", () => {
        console.info("minimize");
        remote.getCurrentWindow().minimize();
      });
      /** Event#maximize */
      titlebar.on("maximize", () => {
        console.info("maximize");
        remote.getCurrentWindow().setFullScreen(false);
        remote.getCurrentWindow().maximize();
      });
      titlebar.on("hover", () => {});
    </script>
    <script>
      /* production */
      // const enav = new (require('electron-navigation'))();

      /* development */

      const enav = new (require("../index.js"))();

      // create a new tab to www.google.com
      enav.newTab(`file:///${__dirname}/mainPage.html`, {
        icon: "../img/site-icon.png",
        title: "Local file",
        close: "false"
      });

      $("#slider").change(function() {
        var opacityValue = $(this).val();
        changeOpacity(opacityValue);
      });
      function changeOpacity(opacity) {
        $("#nav-body-views").css("opacity", opacity);
      }
    </script>
  </body>
</html>
